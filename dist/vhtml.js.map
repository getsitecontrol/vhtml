{"version":3,"file":"vhtml.js","sources":["../src/empty-tags.js","../src/vhtml.js"],"sourcesContent":["export default [\n\t'area',\n\t'base',\n\t'br',\n\t'col',\n\t'command',\n\t'embed',\n\t'hr',\n\t'img',\n\t'input',\n\t'keygen',\n\t'link',\n\t'meta',\n\t'param',\n\t'source',\n\t'track',\n\t'wbr'\n];","import emptyTags from './empty-tags';\n\n// escape an attribute\nconst map = {'&':'amp','<':'lt','>':'gt','\"':'quot',\"'\":'apos'};\nlet sanitized = {};\n\nexport const options = {\n\tnoEscape:[\n\t\t'style',\n\t\t'script'\n\t],\n\temptyTags,\n\tescape(str) {\n\t\treturn String(str).replace(/[&<>\"']/g, s=>`&${map[s]};`);\n\t},\n\tnormalizeAttr (attr) {\n\t\treturn attr.toLowerCase();\n\t},\n\tnormalizeAttrValue (attr,value) {\n\t\treturn value;\n\t},\n\tnormalizeNode (node) {\n\t\treturn node.toLowerCase();\n\t},\n\tDOMAttributeNames: {\n\t\tclassName: 'class',\n\t\thtmlFor: 'for'\n\t}\n};\n\n/** Hyperscript reviver that constructs a sanitized HTML string. */\nexport function h(name, attrs) {\n\tlet stack=[];\n\tfor (let i=arguments.length; i-- > 2; ) {\n\t\tstack.push(arguments[i]);\n\t}\n\n\t// Sortof component support!\n\tif (typeof name==='function') {\n\t\t(attrs || (attrs = {})).children = stack.reverse();\n\t\treturn name(attrs);\n\t\t// return name(attrs, stack.reverse());\n\t}\n\n\tlet s = `<${options.normalizeNode(name)}`;\n\tif (attrs) for (let i in attrs) {\n\t\tif (attrs[i]!==false && attrs[i]!=null) {\n\t\t\tconst attrName = options.DOMAttributeNames[i] ? options.normalizeAttr(options.DOMAttributeNames[i]) : options.escape(options.normalizeAttr(i));\n\t\t\tconst attrValue = options.escape(options.normalizeAttrValue(attrName,attrs[i]));\n\t\t\tif (attrName && attrValue){\n\t\t\t\ts += ` ${attrName}=\"${attrValue}\"`;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (emptyTags.indexOf(name) === -1) {\n\t\ts += '>';\n\n\t\twhile (stack.length) {\n\t\t\tlet child = stack.pop();\n\t\t\tif (child) {\n\t\t\t\tif (child.pop) {\n\t\t\t\t\tfor (let i=child.length; i--; ) stack.push(child[i]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ts += sanitized[child]===true || options.noEscape.indexOf(name) !== -1 ? child : options.escape(child);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ts += `</${options.normalizeNode(name)}>`;\n\t} else {\n\t\ts += '>';\n\t}\n\n\tsanitized[s] = true;\n\treturn s;\n}\n"],"names":["map","sanitized","options","str","String","replace","s","attr","toLowerCase","value","node","h","name","attrs","stack","i","arguments","length","push","children","reverse","normalizeNode","attrName","DOMAttributeNames","normalizeAttr","escape","attrValue","normalizeAttrValue","emptyTags","indexOf","child","pop","noEscape"],"mappings":";;;;;;AAAA,gBAAe,CACd,MADc,EAEd,MAFc,EAGd,IAHc,EAId,KAJc,EAKd,SALc,EAMd,OANc,EAOd,IAPc,EAQd,KARc,EASd,OATc,EAUd,QAVc,EAWd,MAXc,EAYd,MAZc,EAad,OAbc,EAcd,QAdc,EAed,OAfc,EAgBd,KAhBc,CAAf;;ACGA,IAAMA,MAAM,EAAC,KAAI,KAAL,EAAW,KAAI,IAAf,EAAoB,KAAI,IAAxB,EAA6B,KAAI,MAAjC,EAAwC,KAAI,MAA5C,EAAZ;AACA,IAAIC,YAAY,EAAhB;;AAEA,AAAO,IAAMC,UAAU;WACb,CACR,OADQ,EAER,QAFQ,CADa;qBAAA;OAAA,kBAMfC,GANe,EAMV;SACJC,OAAOD,GAAP,EAAYE,OAAZ,CAAoB,UAApB,EAAgC;gBAAOL,IAAIM,CAAJ,CAAP;GAAhC,CAAP;EAPqB;cAAA,yBASPC,IATO,EASD;SACbA,KAAKC,WAAL,EAAP;EAVqB;mBAAA,8BAYFD,IAZE,EAYGE,KAZH,EAYU;SACxBA,KAAP;EAbqB;cAAA,yBAePC,IAfO,EAeD;SACbA,KAAKF,WAAL,EAAP;EAhBqB;;oBAkBH;aACP,OADO;WAET;;CApBJ;;AAyBP,AAAO,SAASG,CAAT,CAAWC,IAAX,EAAiBC,KAAjB,EAAwB;KAC1BC,QAAM,EAAV;MACK,IAAIC,IAAEC,UAAUC,MAArB,EAA6BF,MAAM,CAAnC,GAAwC;QACjCG,IAAN,CAAWF,UAAUD,CAAV,CAAX;;;KAIG,OAAOH,IAAP,KAAc,UAAlB,EAA8B;GAC5BC,UAAUA,QAAQ,EAAlB,CAAD,EAAwBM,QAAxB,GAAmCL,MAAMM,OAAN,EAAnC;SACOR,KAAKC,KAAL,CAAP;;;KAIGP,UAAQJ,QAAQmB,aAAR,CAAsBT,IAAtB,CAAZ;KACIC,KAAJ,EAAW,KAAK,IAAIE,EAAT,IAAcF,KAAd,EAAqB;MAC3BA,MAAME,EAAN,MAAW,KAAX,IAAoBF,MAAME,EAAN,KAAU,IAAlC,EAAwC;OACjCO,WAAWpB,QAAQqB,iBAAR,CAA0BR,EAA1B,IAA+Bb,QAAQsB,aAAR,CAAsBtB,QAAQqB,iBAAR,CAA0BR,EAA1B,CAAtB,CAA/B,GAAqFb,QAAQuB,MAAR,CAAevB,QAAQsB,aAAR,CAAsBT,EAAtB,CAAf,CAAtG;OACMW,YAAYxB,QAAQuB,MAAR,CAAevB,QAAQyB,kBAAR,CAA2BL,QAA3B,EAAoCT,MAAME,EAAN,CAApC,CAAf,CAAlB;OACIO,YAAYI,SAAhB,EAA0B;eAChBJ,QAAT,UAAsBI,SAAtB;;;;;KAKCE,UAAUC,OAAV,CAAkBjB,IAAlB,MAA4B,CAAC,CAAjC,EAAoC;OAC9B,GAAL;;SAEOE,MAAMG,MAAb,EAAqB;OAChBa,QAAQhB,MAAMiB,GAAN,EAAZ;OACID,KAAJ,EAAW;QACNA,MAAMC,GAAV,EAAe;UACT,IAAIhB,MAAEe,MAAMb,MAAjB,EAAyBF,KAAzB;YAAsCG,IAAN,CAAWY,MAAMf,GAAN,CAAX;;KADjC,MAGK;UACCd,UAAU6B,KAAV,MAAmB,IAAnB,IAA2B5B,QAAQ8B,QAAR,CAAiBH,OAAjB,CAAyBjB,IAAzB,MAAmC,CAAC,CAA/D,GAAmEkB,KAAnE,GAA2E5B,QAAQuB,MAAR,CAAeK,KAAf,CAAhF;;;;;cAKO5B,QAAQmB,aAAR,CAAsBT,IAAtB,CAAV;EAfD,MAgBO;OACD,GAAL;;;WAGSN,CAAV,IAAe,IAAf;QACOA,CAAP;;;;;;;;;;;;;;"}